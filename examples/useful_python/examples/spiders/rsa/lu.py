import binascii

import rsa
from Crypto.Cipher import PKCS1_v1_5
from Crypto.PublicKey import RSA
from numpy import long


# 选取的填充方式不同得到的结果也不同

def useRsaEn(str):
    n = "BE24E372DC1B329633A6A014A7C02797915E3C363DD6EE119377BD645329B7E6446B4A71AC5F878EBC870C6D8BFD3C06B92E6C6E93390B34192A7A9E430800091761473FAC2CC0A68A828B2589A8CB729C19161E8E27F4C0F3CDE9701FAFE48D2B65947799072AFA6A3F2D7BDBEF8B6D7429C2D115A3E5F723467D57B3AC6967"
    rsaPublickey = long(n, 16)  # n为modulus
    key = rsa.PublicKey(rsaPublickey, 65537)  # 65537 为e，一般等于010001

    passwd = rsa.encrypt(str, key)
    print(passwd)
    passwd = binascii.b2a_hex(passwd)
    print(passwd)
    return passwd




if __name__ == "__main__":
    key = """
BE24E372DC1B329633A6A014A7C02797915E3C363DD6EE119377BD645329B7E6
446B4A71AC5F878EBC870C6D8BFD3C06B92E6C6E93390B34192A7A9E43080009
1761473FAC2CC0A68A828B2589A8CB729C19161E8E27F4C0F3CDE9701FAFE48D
2B65947799072AFA6A3F2D7BDBEF8B6D7429C2D115A3E5F723467D57B3AC6967
"""
    key = """-----BEGIN PUBLIC KEY-----
{rsaPublicKey}
-----END PUBLIC KEY-----""".format(rsaPublicKey=key)


    key = '''-----BEGIN PUBLIC KEY-----
BE24E372DC1B329633A6A014A7C02797915E3C363DD6EE119377BD645329B7E6
446B4A71AC5F878EBC870C6D8BFD3C06B92E6C6E93390B34192A7A9E43080009
1761473FAC2CC0A68A828B2589A8CB729C19161E8E27F4C0F3CDE9701FAFE48D
2B65947799072AFA6A3F2D7BDBEF8B6D7429C2D115A3E5F723467D57B3AC6967
-----END PUBLIC KEY-----
'''

    print(key)

    # 10001
    text = "111111"
    content = text.encode('utf-8')

    useRsaEn(content)
